from typing import Union

from datasets import Features, Value
from datasets.packaged_modules import csv
from sia.config import MultiParticipant, MultiParticipantConfig

class FeaturesConfig(MultiParticipantConfig, csv.CsvConfig):
    def __init__(
        self,
        train_participants: list[Union[str, int]] = [],
        val_participants: list[Union[str, int]] = [],
        test_participants: list[Union[str, int]] = [],
        *args,
        **kwargs
    ):
        """
        Parameters
        ----------
        train_participants : list[Union[str, int]]
            List of participants to be used for training.
        val_participants : list[Union[str, int]]
            List of participants to be used for validation. 
        test_participants : list[Union[str, int]]
            List of participants to be used for testing.
        """
        MultiParticipantConfig.__init__(self, train_participants, val_participants, test_participants)
        csv.CsvConfig.__init__(self, *args, **kwargs)

class Features(MultiParticipant, csv.Csv):
    BUILDER_CONFIG_CLASS = FeaturesConfig

    BUILDER_CONFIGS = [
        FeaturesConfig(
            name="Features", 
            description="Features data",
            version="1.0.0", 
            skiprows=1,
            column_names=[
                'category',
                'hr_min',
                'hr_max',
                'hr_mean',
                'hr_std',
                'hrv_mean',
                'hrv_std',
                'hrv_rms',
                'cvnn',
                'cvsd',
                'nn20',
                'pnn20',
                'nn50',
                'pnn50',
                'ulf_Feature.MIN',
                'vlf_Feature.MIN',
                'lf_Feature.MIN',
                'hf_Feature.MIN',
                'vhf_Feature.MIN',
                'uhf_Feature.MIN',
                'tp_Feature.MIN',
                'lp_ulf_Feature.MIN',
                'lp_vlf_Feature.MIN',
                'lp_lf_Feature.MIN',
                'lp_hf_Feature.MIN',
                'lp_vhf_Feature.MIN',
                'lp_uhf_Feature.MIN',
                'lf_hf_Feature.MIN',
                'ulf_Feature.MAX',
                'vlf_Feature.MAX',
                'lf_Feature.MAX',
                'hf_Feature.MAX',
                'vhf_Feature.MAX',
                'uhf_Feature.MAX',
                'tp_Feature.MAX',
                'lp_ulf_Feature.MAX',
                'lp_vlf_Feature.MAX',
                'lp_lf_Feature.MAX',
                'lp_hf_Feature.MAX',
                'lp_vhf_Feature.MAX',
                'lp_uhf_Feature.MAX',
                'lf_hf_Feature.MAX',
                'ulf_Feature.MEAN',
                'vlf_Feature.MEAN',
                'lf_Feature.MEAN',
                'hf_Feature.MEAN',
                'vhf_Feature.MEAN',
                'uhf_Feature.MEAN',
                'tp_Feature.MEAN',
                'lp_ulf_Feature.MEAN',
                'lp_vlf_Feature.MEAN',
                'lp_lf_Feature.MEAN',
                'lp_hf_Feature.MEAN',
                'lp_vhf_Feature.MEAN',
                'lp_uhf_Feature.MEAN',
                'lf_hf_Feature.MEAN',
                'ulf_Feature.STD',
                'vlf_Feature.STD',
                'lf_Feature.STD',
                'hf_Feature.STD',
                'vhf_Feature.STD',
                'uhf_Feature.STD',
                'tp_Feature.STD',
                'lp_ulf_Feature.STD',
                'lp_vlf_Feature.STD',
                'lp_lf_Feature.STD',
                'lp_hf_Feature.STD',
                'lp_vhf_Feature.STD',
                'lp_uhf_Feature.STD',
                'lf_hf_Feature.STD',
                'ulf_Feature.POWER',
                'vlf_Feature.POWER',
                'lf_Feature.POWER',
                'hf_Feature.POWER',
                'vhf_Feature.POWER',
                'uhf_Feature.POWER',
                'tp_Feature.POWER',
                'lp_ulf_Feature.POWER',
                'lp_vlf_Feature.POWER',
                'lp_lf_Feature.POWER',
                'lp_hf_Feature.POWER',
                'lp_vhf_Feature.POWER',
                'lp_uhf_Feature.POWER',
                'lf_hf_Feature.POWER',
                'ulf_Feature.COVARIANCE',
                'vlf_Feature.COVARIANCE',
                'lf_Feature.COVARIANCE',
                'hf_Feature.COVARIANCE',
                'vhf_Feature.COVARIANCE',
                'uhf_Feature.COVARIANCE',
                'tp_Feature.COVARIANCE',
                'lp_ulf_Feature.COVARIANCE',
                'lp_vlf_Feature.COVARIANCE',
                'lp_lf_Feature.COVARIANCE',
                'lp_hf_Feature.COVARIANCE',
                'lp_vhf_Feature.COVARIANCE',
                'lp_uhf_Feature.COVARIANCE',
                'lf_hf_Feature.COVARIANCE',
                'ulf_Feature.ENERGY',
                'vlf_Feature.ENERGY',
                'lf_Feature.ENERGY',
                'hf_Feature.ENERGY',
                'vhf_Feature.ENERGY',
                'uhf_Feature.ENERGY',
                'tp_Feature.ENERGY',
                'lp_ulf_Feature.ENERGY',
                'lp_vlf_Feature.ENERGY',
                'lp_lf_Feature.ENERGY',
                'lp_hf_Feature.ENERGY',
                'lp_vhf_Feature.ENERGY',
                'lp_uhf_Feature.ENERGY',
                'lf_hf_Feature.ENERGY',
                'ulf_Feature.ENTROPY',
                'vlf_Feature.ENTROPY',
                'lf_Feature.ENTROPY',
                'hf_Feature.ENTROPY',
                'vhf_Feature.ENTROPY',
                'uhf_Feature.ENTROPY',
                'tp_Feature.ENTROPY',
                'lp_ulf_Feature.ENTROPY',
                'lp_vlf_Feature.ENTROPY',
                'lp_lf_Feature.ENTROPY',
                'lp_hf_Feature.ENTROPY',
                'lp_vhf_Feature.ENTROPY',
                'lp_uhf_Feature.ENTROPY',
                'lf_hf_Feature.ENTROPY',
                'apen',
                'sampen',
                'fuzzyen',
                'sd1',
                'sd2',
                'sd1_sd2',
                'w',
                'wmax',
                'wen',
                'pss',
                'twa',
            ],
            features=Features({
                'category': Value('string'),
                'hr_min':  Value('float64'),
                'hr_max':  Value('float64'),
                'hr_mean':  Value('float64'),
                'hr_std':  Value('float64'),
                'hrv_mean':  Value('float64'),
                'hrv_std':  Value('float64'),
                'hrv_rms':  Value('float64'),
                'cvnn':  Value('float64'),
                'cvsd':  Value('float64'),
                'nn20':  Value('float64'),
                'pnn20':  Value('float64'),
                'nn50':  Value('float64'),
                'pnn50':  Value('float64'),
                'ulf_Feature.MIN':  Value('float64'),
                'vlf_Feature.MIN':  Value('float64'),
                'lf_Feature.MIN':  Value('float64'),
                'hf_Feature.MIN':  Value('float64'),
                'vhf_Feature.MIN':  Value('float64'),
                'uhf_Feature.MIN':  Value('float64'),
                'tp_Feature.MIN':  Value('float64'),
                'lp_ulf_Feature.MIN':  Value('float64'),
                'lp_vlf_Feature.MIN':  Value('float64'),
                'lp_lf_Feature.MIN':  Value('float64'),
                'lp_hf_Feature.MIN':  Value('float64'),
                'lp_vhf_Feature.MIN':  Value('float64'),
                'lp_uhf_Feature.MIN':  Value('float64'),
                'lf_hf_Feature.MIN':  Value('float64'),
                'ulf_Feature.MAX':  Value('float64'),
                'vlf_Feature.MAX':  Value('float64'),
                'lf_Feature.MAX':  Value('float64'),
                'hf_Feature.MAX':  Value('float64'),
                'vhf_Feature.MAX':  Value('float64'),
                'uhf_Feature.MAX':  Value('float64'),
                'tp_Feature.MAX':  Value('float64'),
                'lp_ulf_Feature.MAX':  Value('float64'),
                'lp_vlf_Feature.MAX':  Value('float64'),
                'lp_lf_Feature.MAX':  Value('float64'),
                'lp_hf_Feature.MAX':  Value('float64'),
                'lp_vhf_Feature.MAX':  Value('float64'),
                'lp_uhf_Feature.MAX':  Value('float64'),
                'lf_hf_Feature.MAX':  Value('float64'),
                'ulf_Feature.MEAN':  Value('float64'),
                'vlf_Feature.MEAN':  Value('float64'),
                'lf_Feature.MEAN':  Value('float64'),
                'hf_Feature.MEAN':  Value('float64'),
                'vhf_Feature.MEAN':  Value('float64'),
                'uhf_Feature.MEAN':  Value('float64'),
                'tp_Feature.MEAN':  Value('float64'),
                'lp_ulf_Feature.MEAN':  Value('float64'),
                'lp_vlf_Feature.MEAN':  Value('float64'),
                'lp_lf_Feature.MEAN':  Value('float64'),
                'lp_hf_Feature.MEAN':  Value('float64'),
                'lp_vhf_Feature.MEAN':  Value('float64'),
                'lp_uhf_Feature.MEAN':  Value('float64'),
                'lf_hf_Feature.MEAN':  Value('float64'),
                'ulf_Feature.STD':  Value('float64'),
                'vlf_Feature.STD':  Value('float64'),
                'lf_Feature.STD':  Value('float64'),
                'hf_Feature.STD':  Value('float64'),
                'vhf_Feature.STD':  Value('float64'),
                'uhf_Feature.STD':  Value('float64'),
                'tp_Feature.STD':  Value('float64'),
                'lp_ulf_Feature.STD':  Value('float64'),
                'lp_vlf_Feature.STD':  Value('float64'),
                'lp_lf_Feature.STD':  Value('float64'),
                'lp_hf_Feature.STD':  Value('float64'),
                'lp_vhf_Feature.STD':  Value('float64'),
                'lp_uhf_Feature.STD':  Value('float64'),
                'lf_hf_Feature.STD':  Value('float64'),
                'ulf_Feature.POWER':  Value('float64'),
                'vlf_Feature.POWER':  Value('float64'),
                'lf_Feature.POWER':  Value('float64'),
                'hf_Feature.POWER':  Value('float64'),
                'vhf_Feature.POWER':  Value('float64'),
                'uhf_Feature.POWER':  Value('float64'),
                'tp_Feature.POWER':  Value('float64'),
                'lp_ulf_Feature.POWER':  Value('float64'),
                'lp_vlf_Feature.POWER':  Value('float64'),
                'lp_lf_Feature.POWER':  Value('float64'),
                'lp_hf_Feature.POWER':  Value('float64'),
                'lp_vhf_Feature.POWER':  Value('float64'),
                'lp_uhf_Feature.POWER':  Value('float64'),
                'lf_hf_Feature.POWER':  Value('float64'),
                'ulf_Feature.COVARIANCE':  Value('float64'),
                'vlf_Feature.COVARIANCE':  Value('float64'),
                'lf_Feature.COVARIANCE':  Value('float64'),
                'hf_Feature.COVARIANCE':  Value('float64'),
                'vhf_Feature.COVARIANCE':  Value('float64'),
                'uhf_Feature.COVARIANCE':  Value('float64'),
                'tp_Feature.COVARIANCE':  Value('float64'),
                'lp_ulf_Feature.COVARIANCE':  Value('float64'),
                'lp_vlf_Feature.COVARIANCE':  Value('float64'),
                'lp_lf_Feature.COVARIANCE':  Value('float64'),
                'lp_hf_Feature.COVARIANCE':  Value('float64'),
                'lp_vhf_Feature.COVARIANCE':  Value('float64'),
                'lp_uhf_Feature.COVARIANCE':  Value('float64'),
                'lf_hf_Feature.COVARIANCE':  Value('float64'),
                'ulf_Feature.ENERGY':  Value('float64'),
                'vlf_Feature.ENERGY':  Value('float64'),
                'lf_Feature.ENERGY':  Value('float64'),
                'hf_Feature.ENERGY':  Value('float64'),
                'vhf_Feature.ENERGY':  Value('float64'),
                'uhf_Feature.ENERGY':  Value('float64'),
                'tp_Feature.ENERGY':  Value('float64'),
                'lp_ulf_Feature.ENERGY':  Value('float64'),
                'lp_vlf_Feature.ENERGY':  Value('float64'),
                'lp_lf_Feature.ENERGY':  Value('float64'),
                'lp_hf_Feature.ENERGY':  Value('float64'),
                'lp_vhf_Feature.ENERGY':  Value('float64'),
                'lp_uhf_Feature.ENERGY':  Value('float64'),
                'lf_hf_Feature.ENERGY':  Value('float64'),
                'ulf_Feature.ENTROPY':  Value('float64'),
                'vlf_Feature.ENTROPY':  Value('float64'),
                'lf_Feature.ENTROPY':  Value('float64'),
                'hf_Feature.ENTROPY':  Value('float64'),
                'vhf_Feature.ENTROPY':  Value('float64'),
                'uhf_Feature.ENTROPY':  Value('float64'),
                'tp_Feature.ENTROPY':  Value('float64'),
                'lp_ulf_Feature.ENTROPY':  Value('float64'),
                'lp_vlf_Feature.ENTROPY':  Value('float64'),
                'lp_lf_Feature.ENTROPY':  Value('float64'),
                'lp_hf_Feature.ENTROPY':  Value('float64'),
                'lp_vhf_Feature.ENTROPY':  Value('float64'),
                'lp_uhf_Feature.ENTROPY':  Value('float64'),
                'lf_hf_Feature.ENTROPY':  Value('float64'),
                'apen':  Value('float64'),
                'sampen':  Value('float64'),
                'fuzzyen':  Value('float64'),
                'sd1':  Value('float64'),
                'sd2':  Value('float64'),
                'sd1_sd2':  Value('float64'),
                'w':  Value('float64'),
                'wmax':  Value('float64'),
                'wen':  Value('float64'),
                'pss':  Value('float64'),
                'twa':  Value('float64'),
            })
        )
    ]

    DEFAULT_CONFIG_NAME = "Features"